<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Recent User Responses</title>
{% load static %}
<link rel="icon" href="{% static 'form_ai/favicon.ico' %}" sizes="any">
<link rel="stylesheet" href="{% static 'form_ai/css/responses.css' %}">
</head>
<body>
<header class="header">
    <h1>Recent User Responses</h1>
    <a href="{% url 'voice_page' %}" class="control-btn back-btn">Back to Voice</a>
</header>

<main class="layout">
    <section class="responses-wrapper">
    <div class="responses">
        {% if conversations %}
        <ul class="responses-list">
        {% for conv in conversations %}
        <li class="response-container">
            <div class="response-meta">
            <div class="meta-row">
                <span class="meta-label">Session ID:</span>
                <span class="meta-value session-id">{{ conv.session_id|default:"N/A" }}</span>
            </div>
            <div class="meta-row">
                <span class="meta-label">Created At:</span>
                <span class="meta-value created-at">{{ conv.created_at|date:"Y-m-d H:i:s" }}</span>
            </div>
            </div>

            {% if conv.user_response %}
            <div class="response-data">
            <strong class="response-data-title">Extracted Responses:</strong>
            <div class="response-fields">
                {% for key, value in conv.user_response.items %}
                <div class="response-field">
                <span class="response-key">{{ key|title }}:</span>
                <span class="response-value {% if value %}value-provided{% else %}value-empty{% endif %}">
                    {{ value|default:"(not provided)" }}
                </span>
                </div>
                {% endfor %}
            </div>
            </div>
            {% else %}
            <div class="empty-response-note">
            <p>No extracted responses available</p>
            </div>
            {% endif %}
        </li>

        {% if not forloop.last %}
        <li class="divider" aria-hidden="true"></li>
        {% endif %}
        {% endfor %}
        </ul>
        {% else %}
        <div class="empty-state">
        <p class="empty-title">No analyzed conversations found.</p>
        <p class="empty-sub">Make sure to complete a conversation and click "Stop" before checking responses.</p>
        </div>
        {% endif %}
    </div>
    </section>
</main>

</body>
</html>
